(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/teacher/course-video/course-video"],{378:function(e,o,t){"use strict";(function(e,o){var n=t(4);t(26),t(27);n(t(25));var r=n(t(379));e.__webpack_require_UNI_MP_PLUGIN__=t,o(r.default)}).call(this,t(1)["default"],t(2)["createPage"])},379:function(e,o,t){"use strict";t.r(o);var n=t(380),r=t(382);for(var s in r)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return r[e]}))}(s);t(384);var u,c=t(46),i=Object(c["default"])(r["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],u);i.options.__file="pages/teacher/course-video/course-video.vue",o["default"]=i.exports},380:function(e,o,t){"use strict";t.r(o);var n=t(381);t.d(o,"render",(function(){return n["render"]})),t.d(o,"staticRenderFns",(function(){return n["staticRenderFns"]})),t.d(o,"recyclableRender",(function(){return n["recyclableRender"]})),t.d(o,"components",(function(){return n["components"]}))},381:function(e,o,t){"use strict";var n;t.r(o),t.d(o,"render",(function(){return r})),t.d(o,"staticRenderFns",(function(){return u})),t.d(o,"recyclableRender",(function(){return s})),t.d(o,"components",(function(){return n}));try{n={uniFilePicker:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker")]).then(t.bind(null,794))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,770))},"u-Input":function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u--input/u--input")]).then(t.bind(null,803))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,o=e.$createElement;e._self._c},s=!1,u=[];r._withStripped=!0},382:function(e,o,t){"use strict";t.r(o);var n=t(383),r=t.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(s);o["default"]=r.a},383:function(e,o,t){"use strict";(function(e,n){var r=t(4);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=r(t(28)),u=r(t(31)),c=e.database(),i={data:function(){return{courseTotalTime:[],totalTime:null,courseNum:null,currentIndex:0,id:1,courseware:[],courseCover:"",courseVideoList:[{id:1,section:"",videoSrc:[]}],courseData:{},courseVideoId:""}},onLoad:function(){this.courseData=n.getStorageSync("courseData"),console.log(this.courseData)},methods:{addItem:function(){var e={id:parseInt(this.id)+1,section:"",videoSrc:[]};this.courseVideoList.push(e),this.id=parseInt(this.id)+1},delItem:function(e){if(1==e.id)return n.showToast({title:"不能删除第1个",icon:"none"}),!1;this.courseVideoList=this.courseVideoList.filter((function(o){return o!=e}))},coursewareUpload:function(){this.$refs.coursewareFiles.upload()},courseCoverUpload:function(){this.$refs.courseCoverFiles.upload()},upload:function(e){this.currentIndex=e,this.$refs.files[e].upload()},select:function(e){this.courseTotalTime.push({cloudPath:e.tempFiles[0].file.cloudPath,duration:e.tempFiles[0].file.duration}),console.log(this.courseTotalTime)},deleteFile:function(e){var o=this;console.log(e.tempFile.cloudPath),this.courseTotalTime.forEach((function(t,n){t.cloudPath==e.tempFile.cloudPath&&o.courseTotalTime.splice(n,1)})),console.log(this.courseTotalTime)},progress:function(e){console.log("上传进度：",e)},success:function(e){var o=this;console.log(e);var t={};e.tempFiles.forEach((function(e){console.log(e),t.name=e.name.substring(0,e.name.indexOf(".")),t.src=e.url,t.size=e.size,o.courseVideoList[o.currentIndex].videoSrc.push(t),t={}}))},fail:function(e){console.log("上传失败：",e)},upCoursewareSelect:function(e){console.log("选择文件：",e)},upCoursewareSuccess:function(e){var o=this;console.log(e);var t={};e.tempFiles.forEach((function(e){t.name=e.name.substring(0,e.name.indexOf(".")),t.src=e.url,t.size=e.size,o.courseware.push(t)}))},upCourseCoverSuccess:function(e){console.log(e.tempFilePaths[0]),this.courseCover=e.tempFilePaths[0]},courseToTime:function(){var e=this;this.courseNum=this.courseTotalTime.length,this.courseTotalTime.forEach((function(o){e.totalTime+=o.duration})),console.log(this.totalTime)},onAccomplish:function(){this.courseToTime(),this.upCourseData()},upCourseData:function(){var e=this;return(0,u.default)(s.default.mark((function o(){var t;return s.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n.showLoading({title:"上传中...",mask:!0}),o.next=3,c.collection("course_video").add({course_name:e.courseData.courseName,subject_type_one:e.courseData.courseType[0],subject_type_two:e.courseData.courseType[1],course_intro:e.courseData.courseIntro,courseware:e.courseware,courseCover:e.courseCover,course_video:e.courseVideoList,course_time:e.totalTime,course_video_num:e.courseNum});case 3:t=o.sent,console.log(t),e.courseVideoId=t.result.id,e.upTeacherClass(),n.hideLoading(),n.showToast({title:"发布成功"}),n.reLaunch({url:"/pages/tabbar/teacher/teacher"});case 10:case"end":return o.stop()}}),o)})))()},upTeacherClass:function(){var e=this;this.courseData.classList.forEach((function(o){console.log(o.courseClass),c.collection("teacher_course").add({course:e.courseVideoId,class:o.courseClass}).then((function(e){console.log(e)}))}))}}};o.default=i}).call(this,t(27)["default"],t(2)["default"])},384:function(e,o,t){"use strict";t.r(o);var n=t(385),r=t.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(s);o["default"]=r.a},385:function(e,o,t){}},[[378,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/teacher/course-video/course-video.js.map