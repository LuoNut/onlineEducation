(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-home-online_note-edit"],{"105a":function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return c})),e.d(n,"a",(function(){return i}));var i={uButton:e("78d4").default},o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"edit"},[e("cu-custom",{attrs:{bgColor:"bg-gradual-blue",isBack:!0}},[e("template",{attrs:{slot:"backText"},slot:"backText"},[t._v("返回")]),e("template",{attrs:{slot:"content"},slot:"content"},[t._v("发布长文")])],2),e("v-uni-view",{staticClass:"container"},[e("v-uni-view",{staticClass:"content"},[e("v-uni-editor",{staticClass:"myEdit",attrs:{placeholder:"写点什么吧......","show-img-size":!0,"show-img-toolbar":!0,"show-img-resize":!0},on:{ready:function(n){arguments[0]=n=t.$handleEvent(n),t.onEditReady.apply(void 0,arguments)},focus:function(n){arguments[0]=n=t.$handleEvent(n),t.onfocus.apply(void 0,arguments)},statuschange:function(n){arguments[0]=n=t.$handleEvent(n),t.statuschange.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"btnGroup"},[e("u-button",{attrs:{type:"primary",text:"确定"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.onSubmit.apply(void 0,arguments)}}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.showTool,expression:"showTool"}],staticClass:"tools"},[e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickHeader.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitibiaoti",class:t.showHeader?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickBold.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitijiacu",class:t.showBold?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickItalic.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitixieti",class:t.showItalic?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickDivider.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-fengexian"})],1),e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.clickInsertImage.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-charutupian"})],1),e("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.okEdit.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-duigoux"})],1)],1)],1)],1)},c=[]},"1e09":function(t,n,e){"use strict";var i=e("f0c6"),o=e.n(i);o.a},"216e":function(t,n,e){var i=e("24fb");n=i(!1),n.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */[data-v-4f5cd00c] .ql-editor::before{font-style:none;color:#e0e0e0}.edit .container[data-v-4f5cd00c]{padding:%?30?%}.edit .container .content .myEdit[data-v-4f5cd00c]{height:calc(100vh - %?500?%);margin-bottom:%?30?%}.edit .container .btnGroup[data-v-4f5cd00c]{margin-top:%?200?%}.edit .container .tools[data-v-4f5cd00c]{position:fixed;left:0;bottom:0;display:flex;justify-content:space-around;align-items:center;width:100%;height:%?80?%;background-color:#fff;border-top:%?1?% solid #f4f4f4}.edit .container .tools .iconfont[data-v-4f5cd00c]{font-size:%?36?%;color:#333}.edit .container .tools .iconfont.active[data-v-4f5cd00c]{color:#0199fe}',""]),t.exports=n},"325c":function(t,n,e){"use strict";(function(t){e("7a82");var i=e("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.courseLikeFun=function(t){return l.apply(this,arguments)},n.getImgSrc=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,e=[];return t.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/g,(function(t,n){e.push(n)})),e=e.slice(0,n),e},n.getProvince=function(){return new Promise((function(t,n){var e=uni.getStorageSync("historyProvince");e?Date.now()-e.time>36e5?r().then((function(n){t(n)})).catch((function(t){n(t)})):t(e.province):r().then((function(n){t(n)})).catch((function(t){n(t)}))}))},n.giveAvatar=function(t){var n,e,i;return null!==(n=null===(e=t.user_id[0])||void 0===e||null===(i=e.avatar_file)||void 0===i?void 0:i.url)&&void 0!==n?n:"/static/images/user-default.jpg"},n.giveName=function(t){var n;return t?null===(n=t.user_id[0])||void 0===n?void 0:n.nickname:""},n.likeFun=function(t){return u.apply(this,arguments)};var o=i(e("c7eb")),c=i(e("1da1"));e("ac1f"),e("5319"),e("14d9"),e("fb6a"),e("d3b7");e("606a");var a=t.database(),s=t.importObject("utils-obj",{customUI:!0});function r(){return new Promise((function(t,n){uni.request({url:"https://restapi.amap.com/v3/ip?key=1e4c4960ff4e574cd39128750c5834ed",success:function(n){var e="";console.log("111"),e="string"===typeof n.data.province?n.data.province:"火星",t(e);var i={province:e,time:Date.now()};uni.setStorageSync("historyProvince",i)},fail:function(t){n(t)}})}))}function u(){return u=(0,c.default)((0,o.default)().mark((function t(n){var e;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.collection("blog_like").where('article_id=="'.concat(n,'" && user_id==$cloudEnv_uid')).count();case 2:e=t.sent,console.log(e),e.result.total?(a.collection("blog_like").where('article_id=="'.concat(n,'" && user_id==$cloudEnv_uid')).remove(),s.operation("blog_article","like_count",n,-1)):a.collection("blog_like").add({article_id:n}).then((function(t){s.operation("blog_article","like_count",n,1)}));case 5:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function l(){return l=(0,c.default)((0,o.default)().mark((function t(n){var e;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.collection("course_like").where('course_id=="'.concat(n,'" && user_id==$cloudEnv_uid')).count();case 2:e=t.sent,console.log(e),e.result.total?(a.collection("course_like").where('course_id=="'.concat(n,'" && user_id==$cloudEnv_uid')).remove(),s.operation("course_video","like_count",n,-1)):a.collection("course_like").add({course_id:n}).then((function(t){s.operation("course_video","like_count",n,1)}));case 5:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}}).call(this,e("a9ff")["default"])},4286:function(t,n,e){"use strict";(function(t){e("7a82");var i=e("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("ac1f"),e("d3b7"),e("159b");var o=i(e("c7eb")),c=i(e("1da1")),a=(e("325c"),t.database()),s={data:function(){return{showTool:!1,showHeader:!1,showBold:!1,showItalic:!1,noteId:"",content:""}},onLoad:function(t){this.noteId=t.id,this.getOnteFun()},methods:{getOnteFun:function(){var t=this;return(0,c.default)((0,o.default)().mark((function n(){var e;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return uni.showLoading({}),n.next=3,a.collection("online_note").where('"'.concat(t.noteId,'" == _id')).get();case 3:e=n.sent,t.content=e.result.data[0].content,setTimeout((function(){t.editorCtx.setContents({html:e.result.data[0].content,success:function(n){t.content=n.html,console.log(e.result.data[0].content),uni.hideLoading()}})}));case 6:case"end":return n.stop()}}),n)})))()},onSubmit:function(){var t=this;this.editorCtx.getContents({success:function(n){t.content=n.html,t.setData()}})},setData:function(){a.collection("online_note").update({content:this.content}).then((function(t){console.log(t),uni.showToast({title:"上传成功",icon:"none"})}))},onfocus:function(){this.showTool=!0},onEditReady:function(){var t=this;uni.createSelectorQuery().in(this).select(".myEdit").fields({size:!0,context:!0},(function(n){t.editorCtx=n.context})).exec()},clickDivider:function(){this.editorCtx.insertDivider()},clickHeader:function(){this.showHeader=!this.showHeader,this.editorCtx.format("header",!!this.showHeader&&"H1")},clickBold:function(){this.showBold=!this.showBold,this.editorCtx.format("bold")},clickItalic:function(){this.showItalic=!this.showItalic,this.editorCtx.format("italic")},clickInsertImage:function(){var n=this;uni.chooseImage({success:function(e){uni.showLoading({title:"上传中...",mask:!0}),e.tempFiles.forEach(function(){var e=(0,c.default)((0,o.default)().mark((function e(i){var c;return(0,o.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.uploadFile({filePath:i.path,cloudPath:i.name});case 2:c=e.sent,n.editorCtx.insertImage({src:c.fileID}),uni.hideLoading();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})},okEdit:function(){this.showTool=!1},checkStatus:function(t,n,e){n.hasOwnProperty(t)?this[e]=!0:this[e]=!1},statuschange:function(t){var n=t.detail;this.checkStatus("header",n,"showHeader"),this.checkStatus("bold",n,"showBold"),this.checkStatus("italic",n,"showItalic")}}};n.default=s}).call(this,e("a9ff")["default"])},"5fc7":function(t,n,e){"use strict";e.r(n);var i=e("105a"),o=e("cbfb");for(var c in o)["default"].indexOf(c)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(c);e("1e09");var a=e("f0c5"),s=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"4f5cd00c",null,!1,i["a"],void 0);n["default"]=s.exports},cbfb:function(t,n,e){"use strict";e.r(n);var i=e("4286"),o=e.n(i);for(var c in i)["default"].indexOf(c)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(c);n["default"]=o.a},f0c6:function(t,n,e){var i=e("216e");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=e("4f06").default;o("01a960ad",i,!0,{sourceMap:!1,shadowMode:!1})}}]);