(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/teacher/course-video/course-video"],{"0f0b":function(e,o,t){"use strict";(function(e,u){var n=t("4ea4");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=n(t("2eee")),i=n(t("c973")),c=e.database(),r={data:function(){return{courseTotalTime:[],totalTime:null,courseNum:null,currentIndex:0,id:1,courseware:[],courseCover:"",courseVideoList:[{id:1,section:"",videoSrc:[]}],courseData:{},courseVideoId:""}},onLoad:function(){this.courseData=u.getStorageSync("courseData"),console.log(this.courseData)},methods:{addItem:function(){var e={id:parseInt(this.id)+1,section:"",videoSrc:[]};this.courseVideoList.push(e),this.id=parseInt(this.id)+1},delItem:function(e){if(1==e.id)return u.showToast({title:"不能删除第1个",icon:"none"}),!1;this.courseVideoList=this.courseVideoList.filter((function(o){return o!=e}))},coursewareUpload:function(){this.$refs.coursewareFiles.upload()},courseCoverUpload:function(){this.$refs.courseCoverFiles.upload()},upload:function(e){this.currentIndex=e,this.$refs.files[e].upload()},select:function(e){this.courseTotalTime.push({cloudPath:e.tempFiles[0].file.cloudPath,duration:e.tempFiles[0].file.duration}),console.log(this.courseTotalTime)},deleteFile:function(e){var o=this;console.log(e.tempFile.cloudPath),this.courseTotalTime.forEach((function(t,u){t.cloudPath==e.tempFile.cloudPath&&o.courseTotalTime.splice(u,1)})),console.log(this.courseTotalTime)},progress:function(e){console.log("上传进度：",e)},success:function(e){var o=this;console.log(e);var t={};e.tempFiles.forEach((function(e){console.log(e),t.name=e.name.substring(0,e.name.indexOf(".")),t.src=e.url,t.size=e.size,o.courseVideoList[o.currentIndex].videoSrc.push(t),t={}}))},fail:function(e){console.log("上传失败：",e)},upCoursewareSelect:function(e){console.log("选择文件：",e)},upCoursewareSuccess:function(e){var o=this;console.log(e);var t={};e.tempFiles.forEach((function(e){t.name=e.name.substring(0,e.name.indexOf(".")),t.src=e.url,t.size=e.size,o.courseware.push(t)}))},upCourseCoverSuccess:function(e){console.log(e.tempFilePaths[0]),this.courseCover=e.tempFilePaths[0]},courseToTime:function(){var e=this;this.courseNum=this.courseTotalTime.length,this.courseTotalTime.forEach((function(o){e.totalTime+=o.duration})),console.log(this.totalTime)},onAccomplish:function(){this.courseToTime(),this.upCourseData()},upCourseData:function(){var e=this;return(0,i.default)(s.default.mark((function o(){var t;return s.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return u.showLoading({title:"上传中...",mask:!0}),o.next=3,c.collection("course_video").add({course_name:e.courseData.courseName,subject_type_one:e.courseData.courseType[0],subject_type_two:e.courseData.courseType[1],course_intro:e.courseData.courseIntro,courseware:e.courseware,courseCover:e.courseCover,course_video:e.courseVideoList,course_time:e.totalTime,course_video_num:e.courseNum});case 3:t=o.sent,console.log(t),e.courseVideoId=t.result.id,e.upTeacherClass(),u.hideLoading(),u.showToast({title:"发布成功"}),u.reLaunch({url:"/pages/tabbar/teacher/teacher"});case 10:case"end":return o.stop()}}),o)})))()},upTeacherClass:function(){var e=this;this.courseData.classList.forEach((function(o){console.log(o.courseClass),c.collection("teacher_course").add({course:e.courseVideoId,class:o.courseClass}).then((function(e){console.log(e)}))}))}}};o.default=r}).call(this,t("a9ff")["default"],t("543d")["default"])},3077:function(e,o,t){"use strict";(function(e,o){var u=t("4ea4");t("dac0"),t("a9ff");u(t("66fd"));var n=u(t("b22c"));e.__webpack_require_UNI_MP_PLUGIN__=t,o(n.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},"545e":function(e,o,t){"use strict";t.d(o,"b",(function(){return n})),t.d(o,"c",(function(){return s})),t.d(o,"a",(function(){return u}));var u={uniFilePicker:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker")]).then(t.bind(null,"dd7b"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,"78d4"))},"u-Input":function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u--input/u--input")]).then(t.bind(null,"5bad"))}},n=function(){var e=this.$createElement;this._self._c},s=[]},aa9e:function(e,o,t){},b22c:function(e,o,t){"use strict";t.r(o);var u=t("545e"),n=t("d478");for(var s in n)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(s);t("c900");var i=t("f0c5"),c=Object(i["a"])(n["default"],u["b"],u["c"],!1,null,null,null,!1,u["a"],void 0);o["default"]=c.exports},c900:function(e,o,t){"use strict";var u=t("aa9e"),n=t.n(u);n.a},d478:function(e,o,t){"use strict";t.r(o);var u=t("0f0b"),n=t.n(u);for(var s in u)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return u[e]}))}(s);o["default"]=n.a}},[["3077","common/runtime","common/vendor"]]]);